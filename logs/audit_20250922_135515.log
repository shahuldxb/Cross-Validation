2025-09-22 13:55:15,722 - INFO - setup_audit_logging:77 - === AUDIT LOG STARTED ===
2025-09-22 13:55:15,722 - INFO - setup_audit_logging:78 - Log file: logs\audit_20250922_135515.log
2025-09-22 13:55:15,724 - INFO - main:442 - === STARTING MAIN APPLICATION ===
2025-09-22 13:55:15,725 - INFO - create_directories:112 - Creating required directories
2025-09-22 13:55:15,727 - INFO - create_directories:118 - Directories created successfully: input/, output/
2025-09-22 13:55:15,727 - INFO - validate_azure_config:84 - Starting Azure OpenAI configuration validation
2025-09-22 13:55:15,727 - INFO - validate_azure_config:100 - Environment variable AZURE_OPENAI_ENDPOINT: SET
2025-09-22 13:55:15,728 - INFO - validate_azure_config:100 - Environment variable AZURE_OPENAI_API_KEY: SET
2025-09-22 13:55:15,729 - INFO - validate_azure_config:100 - Environment variable AZURE_OPENAI_API_VERSION: SET
2025-09-22 13:55:15,730 - INFO - validate_azure_config:100 - Environment variable AZURE_OPENAI_CHAT_DEPLOYMENT: SET
2025-09-22 13:55:15,730 - INFO - validate_azure_config:107 - Azure OpenAI configuration validation completed successfully
2025-09-22 13:55:15,730 - INFO - main:453 - Application initialization completed
2025-09-22 13:55:15,750 - INFO - split_secondary_documents:174 - Starting AI-based secondary document splitting
2025-09-22 13:55:15,750 - DEBUG - split_secondary_documents:180 - Secondary content size: 2887 characters
2025-09-22 13:55:15,750 - INFO - split_secondary_documents:224 - Sending content to Azure OpenAI for document splitting
2025-09-22 13:55:31,164 - DEBUG - split_secondary_documents:245 - AI response: [
  {
    "heading": "COMMERCIAL INVOICE",
    "content": "COMMERCIAL INVOICE\n\nSeller: Shenzhen PowerTech Co. Ltd., Shenzhen, China\nInvoice No.: INV-2025-1025\nDate of Invoice: 25 October 2025\nBuy...
2025-09-22 13:55:31,164 - INFO - split_secondary_documents:250 - Successfully parsed JSON response with 5 documents
2025-09-22 13:55:31,164 - DEBUG - split_secondary_documents:261 - AI identified document: COMMERCIAL INVOICE -> Commercial Invoice
2025-09-22 13:55:31,164 - DEBUG - split_secondary_documents:261 - AI identified document: PACKING LIST -> Packing List
2025-09-22 13:55:31,164 - DEBUG - split_secondary_documents:261 - AI identified document: CERTIFICATE OF ORIGIN -> Certificate of Origin
2025-09-22 13:55:31,164 - DEBUG - split_secondary_documents:261 - AI identified document: INSPECTION CERTIFICATE -> Unknown
2025-09-22 13:55:31,164 - DEBUG - split_secondary_documents:261 - AI identified document: DANGEROUS GOODS DECLARATION -> Unknown
2025-09-22 13:55:31,164 - INFO - split_secondary_documents:263 - AI-based document splitting completed. Found 5 documents
2025-09-22 13:55:31,165 - INFO - split_secondary_documents:268 - Document 1: COMMERCIAL INVOICE (Commercial Invoice) - 547 chars
2025-09-22 13:55:31,165 - INFO - split_secondary_documents:268 - Document 2: PACKING LIST (Packing List) - 571 chars
2025-09-22 13:55:31,165 - INFO - split_secondary_documents:268 - Document 3: CERTIFICATE OF ORIGIN (Certificate of Origin) - 500 chars
2025-09-22 13:55:31,165 - INFO - split_secondary_documents:268 - Document 4: INSPECTION CERTIFICATE (Unknown) - 584 chars
2025-09-22 13:55:31,165 - INFO - split_secondary_documents:268 - Document 5: DANGEROUS GOODS DECLARATION (Unknown) - 552 chars
2025-09-22 13:55:31,169 - INFO - clean_input_directory:122 - Cleaning input directory
2025-09-22 13:55:31,170 - DEBUG - clean_input_directory:132 - Deleted file: Bill of Lading.txt
2025-09-22 13:55:31,170 - DEBUG - clean_input_directory:132 - Deleted file: ilc.txt
2025-09-22 13:55:31,171 - DEBUG - clean_input_directory:132 - Deleted file: Insurance Certificate.txt
2025-09-22 13:55:31,171 - INFO - clean_input_directory:138 - Cleaned input directory. Deleted 3 files: ['Bill of Lading.txt', 'ilc.txt', 'Insurance Certificate.txt']
2025-09-22 13:55:31,171 - INFO - save_primary_document:142 - Saving primary document with code: ILC
2025-09-22 13:55:31,172 - INFO - save_primary_document:161 - Primary document saved successfully: input\ilc.txt
2025-09-22 13:55:31,172 - DEBUG - save_primary_document:162 - Primary document size: 733 characters
2025-09-22 13:55:31,173 - INFO - save_primary_document:163 - Added LC heading for cross_new_csv.py compatibility
2025-09-22 13:55:31,173 - INFO - save_primary_document:164 - Using lowercase filename ilc.txt for LC detection
2025-09-22 13:55:31,173 - INFO - split_secondary_documents:174 - Starting AI-based secondary document splitting
2025-09-22 13:55:31,174 - DEBUG - split_secondary_documents:180 - Secondary content size: 2887 characters
2025-09-22 13:55:31,174 - INFO - split_secondary_documents:224 - Sending content to Azure OpenAI for document splitting
2025-09-22 13:55:43,522 - DEBUG - split_secondary_documents:245 - AI response: [
  {
    "heading": "COMMERCIAL INVOICE",
    "content": "COMMERCIAL INVOICE\n\nSeller: Shenzhen PowerTech Co. Ltd., Shenzhen, China\nInvoice No.: INV-2025-1025\nDate of Invoice: 25 October 2025\nBuy...
2025-09-22 13:55:43,523 - INFO - split_secondary_documents:250 - Successfully parsed JSON response with 5 documents
2025-09-22 13:55:43,523 - DEBUG - split_secondary_documents:261 - AI identified document: COMMERCIAL INVOICE -> Commercial Invoice
2025-09-22 13:55:43,523 - DEBUG - split_secondary_documents:261 - AI identified document: PACKING LIST -> Packing List
2025-09-22 13:55:43,523 - DEBUG - split_secondary_documents:261 - AI identified document: CERTIFICATE OF ORIGIN -> Certificate of Origin
2025-09-22 13:55:43,523 - DEBUG - split_secondary_documents:261 - AI identified document: INSPECTION CERTIFICATE -> Unknown
2025-09-22 13:55:43,523 - DEBUG - split_secondary_documents:261 - AI identified document: DANGEROUS GOODS DECLARATION -> Unknown
2025-09-22 13:55:43,523 - INFO - split_secondary_documents:263 - AI-based document splitting completed. Found 5 documents
2025-09-22 13:55:43,523 - INFO - split_secondary_documents:268 - Document 1: COMMERCIAL INVOICE (Commercial Invoice) - 547 chars
2025-09-22 13:55:43,523 - INFO - split_secondary_documents:268 - Document 2: PACKING LIST (Packing List) - 571 chars
2025-09-22 13:55:43,524 - INFO - split_secondary_documents:268 - Document 3: CERTIFICATE OF ORIGIN (Certificate of Origin) - 500 chars
2025-09-22 13:55:43,524 - INFO - split_secondary_documents:268 - Document 4: INSPECTION CERTIFICATE (Unknown) - 584 chars
2025-09-22 13:55:43,524 - INFO - split_secondary_documents:268 - Document 5: DANGEROUS GOODS DECLARATION (Unknown) - 552 chars
2025-09-22 13:55:43,524 - INFO - save_secondary_documents:280 - Saving 5 secondary documents
2025-09-22 13:55:43,525 - INFO - save_secondary_documents:309 - Saved secondary document: COMMERCIAL INVOICE.txt (Commercial Invoice) with heading: Commercial Invoice (INV)
2025-09-22 13:55:43,527 - INFO - save_secondary_documents:309 - Saved secondary document: PACKING LIST.txt (Packing List) with heading: Packing List (PL)
2025-09-22 13:55:43,528 - INFO - save_secondary_documents:309 - Saved secondary document: CERTIFICATE OF ORIGIN.txt (Certificate of Origin) with heading: Insurance Certificate (INS)
2025-09-22 13:55:43,529 - INFO - save_secondary_documents:309 - Saved secondary document: INSPECTION CERTIFICATE.txt (Unknown) with heading: Trade Document (Unknown)
2025-09-22 13:55:43,530 - INFO - save_secondary_documents:309 - Saved secondary document: DANGEROUS GOODS DECLARATION.txt (Unknown) with heading: Trade Document (Unknown)
2025-09-22 13:55:43,530 - INFO - save_secondary_documents:316 - Successfully saved 5 secondary documents
2025-09-22 13:55:43,544 - INFO - run_discrepancy_analysis:342 - Starting discrepancy analysis
2025-09-22 13:55:43,545 - INFO - run_discrepancy_analysis:347 - Checking for analysis script: cross_new_csv.py
2025-09-22 13:55:43,548 - INFO - run_discrepancy_analysis:355 - Analysis script found, preparing to execute
2025-09-22 13:55:43,549 - INFO - run_discrepancy_analysis:360 - Input files for analysis: ['CERTIFICATE OF ORIGIN.txt', 'COMMERCIAL INVOICE.txt', 'DANGEROUS GOODS DECLARATION.txt', 'ilc.txt', 'INSPECTION CERTIFICATE.txt', 'PACKING LIST.txt']
2025-09-22 13:55:43,550 - INFO - run_discrepancy_analysis:363 - Executing cross_new_csv.py script
2025-09-22 13:56:25,449 - INFO - run_discrepancy_analysis:371 - Script execution completed with return code: 0
2025-09-22 13:56:25,449 - INFO - run_discrepancy_analysis:374 - Script stdout: [*] Starting Trade Finance Compliance Analysis
==================================================
[OK] Folders ready: .\input and .\output
[OK] Found 6 .txt files:
  - CERTIFICATE OF ORIGIN.txt
  - COMMERCIAL INVOICE.txt
  - DANGEROUS GOODS DECLARATION.txt
  - ilc.txt
  - INSPECTION CERTIFICATE.txt
  - PACKING LIST.txt
[OK] LC document identified by filename: ilc.txt
[OK] Secondary documents: 5 files

[PROCESSING] Building analysis prompt...
[PROCESSING] Sending documents to Azure OpenAI for analysis...
[OK] Analysis completed successfully
[OK] Results saved to: .\output\compliance_analysis_ilc_20250922_135625.md
[OK] CSV exported: .\output\compliance_analysis_ilc_20250922_135625.csv

==================================================
[SUCCESS] Compliance Analysis Completed Successfully!
[REPORT] Report saved to: .\output\compliance_analysis_ilc_20250922_135625.md
[CSV] CSV exported alongside the report in the output folder.
[STATS] Base Document: ilc.txt
[FILES] Secondary Documents: 5 files analyzed

2025-09-22 13:56:25,450 - INFO - run_discrepancy_analysis:388 - Found analysis report: output\compliance_analysis_ilc_20250922_135625.md
2025-09-22 13:56:25,451 - INFO - run_discrepancy_analysis:392 - Found analysis CSV: output\compliance_analysis_ilc_20250922_135625.csv
2025-09-22 13:56:25,451 - INFO - run_discrepancy_analysis:399 - Discrepancy analysis completed successfully
2025-09-22 13:56:25,453 - INFO - display_file_content:411 - Displaying file content: output\compliance_analysis_ilc_20250922_135625.md (type: text)
2025-09-22 13:56:25,461 - INFO - display_file_content:430 - Successfully displayed text content (8003 characters)
2025-09-22 13:56:25,463 - INFO - display_file_content:411 - Displaying file content: output\compliance_analysis_ilc_20250922_135625.csv (type: csv)
2025-09-22 13:56:25,483 - INFO - display_file_content:417 - Successfully displayed CSV with 12 rows
